### 概述

这是关于项目自动化测试方案描述，基于`docker`容器化，包括应用容器化、环境搭建、镜像仓库、自动化、性能压测、持续集成、后期维护、业务监控、安全测试以及弹性伸缩等。

[TOC]

### 应用容器化

- 环境分析
- 配置分离
- 容器化

对于环境分析，需要分析目前环境对接的第三方配置以及拓扑图，能否实现各个部件的内网搭建，以及处理无法内网部署的服务。

对于配置分离，是将配置项与代码剥离，实现解耦，方便容器的部署以及可能的微服务（后期的服务解耦）。

对于容器化，主要是编写`Dockerfile`实现应用构建步骤以及设置配置项，方便后期的容器集成。或者通过容器来快速安装，进行版本级功能以及接口兼容性验证。

采用容器化，测试或者开发拥有一致的环境，减少环境因素干扰，以及环境自动化部署，方便自动化用例的调试。

> **对于不能实现容器，也可以在通过`Dockerfile`来进行代码构建以及`ansible`插件部署**
>
> **测试环境安装的容器化，实现持续集成与测试**

优先级：较高

###环境搭建

* 服务器
* 安装编排

对于服务器，需要规划好资源（不确定是公网还是内网服务器，需要申请购买），进行后续的安装编排，实现自动构建部署，实现敏捷。

对于环境安装，需要编写安装脚本实现检查环境变量，应用版本显示版本标识，方便`bug`版本环境说明。

> **对于版本标识需要控制**

优先级：较高

###镜像仓库

存储应用镜像，以及镜像版本控制，在安装编排中进行制定版本安装。

###自动化

* 接口自动化工具
* 接口分析
* 自动化范围
* 代码覆盖率
* 测试桩

对于接口自动化工具，目前考虑`httprunner`以及`robotframework`，推荐使用`httprunner`，当考虑到开发未提供接口文档或者接口文档不清晰，可以通过抓包，来生成接口接口自动化用例。

对于接口分析，需要理清接口逻辑以及数据库入库，基于用户数据层面，实现端到端的自动化测试。

对于自动化范围，`app`端自动化以及接口自动化。

通过代码覆盖率来确定是否增加自动化用例，`java`加载`jacoco`来实现。

采用测试桩来实现环境中无法安装的服务，需要评估环境需要安装哪些测试桩。

> **需要考虑的是`KTP`的人脸识别以及`OCR`图像识别的实现方式**
>
> **翻译文件产品提供csv格式文件，提交到代码库进行版本跟踪，方便集成到测试脚本中**
>
> **`httprunner`工具目前还是处于完善阶段，可能会有坑，需要实践以及查看源码**

优先级：较高

### 性能压测

如果采用`httprunner`工具，可以通过其内置的压力测试工具`Locust `来实现，复用自动化用例。

> **需要确认后期的用户量以及性能指标，性能环境搭建，提前发现性能瓶颈**
>
> **经验问题，效果不是很明显**

### 持续集成

`jenkins`来实现构建以及安装部署，自动化测试流水线。

### 后期维护

需要与开发确认接口变更流程以及文档编写，以及自动化测试用例编写规划。

> **对于文档编写，推荐采用`confluence`团队协作的wiki编写工具，后期可以考虑产品需求文档迁移到`confluence`中，需要申请机器搭建。**

优先级：较高

### 需求模块开发人员列表

版本需求开发人员名单，有开发提供列表，统计开发进度；开发提供需求设计方案（服务端接口侧），进行设计方案评审，测试根据方案设计测试场景，编写自动化用例。

优先级：较高

### 业务时序

产品侧提供业务流程图或者思维导图，手工画或者工具画。

> **容易理解，不易误解，同时需求变动不大。**

优先级：较高

### 版本开发`BUG`数量

统计版本`bug`，质量维护，确认是产品或者开发质量，进行质量回溯。

### 交付测试

交付内容有升级方案、版本包、数据库`sql`、升级说明。将构建生成的版本包和`sql`放置到`gitlab`的`release`页面，提供说明。

`sql`提交到代码仓库进行版本控制，方便版本迭代数据库的验证，同时在构建环境编写脚本来升级数据库。

以上可以通过一些插件来实现自动化。

> **具体来说，当修改了某一项后，可以通过再次构建来验证功能正确，环境可移植以及接口功能自动化，升级方案进行评估升级影响范围和细节。**
>
> **`sql`不会花费时间来二次整理**

优先级：较高

###控制台爬虫

编写爬虫脚本，检查网站的超链接是否正常。

### 监控方案

实现服务器、数据库以及业务流量监控。todo

> **Prometheus实现测试和线上环境监控**

### 弹性伸缩

todo

### 容灾方案

todo

### 持续交付平台

PAAS工具选型，todo

